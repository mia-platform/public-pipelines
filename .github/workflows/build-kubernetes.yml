name: Build Kubernetes Image

on:
  workflow_call:
    secrets:
      BOT_DOCKER_USERNAME:
        required: true
      BOT_DOCKER_TOKEN:
        required: true
      BOT_USER:
        required: true
      BOT_GITHUB_TOKEN:
        required: true

jobs:
  build-kubernetes-1-26-image:
    uses: ./.github/workflows/build-image.yml
    with:
      image_path: containers/kubernetes
      image_name: kubernetes-pipeline
      image_tag: "1.26"
      build_args: |
        KUBECTL_VERSION=v1.26.12
        KUBECTL_CHECKSUM=8e6af8d68e7b9d2a1eb43255c0da793276e549a34a2b9c3c87a9c26438e7fd71
        KUBECTL_CHECKSUM_ARM=b9cfdb6c9a53146330d5694e711c48febb7ec022aea8d16a51b5e12d761580cc
    secrets:
      DOCKER_USERNAME: ${{ secrets.BOT_DOCKER_USERNAME }}
      DOCKER_TOKEN: ${{ secrets.BOT_DOCKER_TOKEN }}
      GH_USERNAME: ${{ secrets.BOT_USER }}
      GH_TOKEN: ${{ secrets.BOT_GITHUB_TOKEN }}

  build-kubernetes-1-27-image:
    uses: ./.github/workflows/build-image.yml
    with:
      image_path: containers/kubernetes
      image_name: kubernetes-pipeline
      image_tag: "1.27"
      build_args: |
        KUBECTL_VERSION=v1.27.9
        KUBECTL_CHECKSUM=d0caae91072297b2915dd65f6ef3055d27646dce821ec67d18da35ba9a8dc85b
        KUBECTL_CHECKSUM_ARM=bda475539fdeda9d8a85a84b967af361af264d0826c121b23b0b62ee9b00cd2d
    secrets:
      DOCKER_USERNAME: ${{ secrets.BOT_DOCKER_USERNAME }}
      DOCKER_TOKEN: ${{ secrets.BOT_DOCKER_TOKEN }}
      GH_USERNAME: ${{ secrets.BOT_USER }}
      GH_TOKEN: ${{ secrets.BOT_GITHUB_TOKEN }}

  build-kubernetes-1-28-image:
    uses: ./.github/workflows/build-image.yml
    with:
      image_path: containers/kubernetes
      image_name: kubernetes-pipeline
      image_tag: "1.28"
      build_args: |
        KUBECTL_VERSION=v1.28.5
        KUBECTL_CHECKSUM=2a44c0841b794d85b7819b505da2ff3acd5950bd1bcd956863714acc80653574
        KUBECTL_CHECKSUM_ARM=f87fe017ae3ccfd93df03bf17edd4089672528107f230563b8c9966909661ef2
    secrets:
      DOCKER_USERNAME: ${{ secrets.BOT_DOCKER_USERNAME }}
      DOCKER_TOKEN: ${{ secrets.BOT_DOCKER_TOKEN }}
      GH_USERNAME: ${{ secrets.BOT_USER }}
      GH_TOKEN: ${{ secrets.BOT_GITHUB_TOKEN }}

  build-kubernetes-image:
    uses: ./.github/workflows/build-image.yml
    with:
      image_path: containers/kubernetes
      image_name: kubernetes-pipeline
      image_tag: "1.29"
    secrets:
      DOCKER_USERNAME: ${{ secrets.BOT_DOCKER_USERNAME }}
      DOCKER_TOKEN: ${{ secrets.BOT_DOCKER_TOKEN }}
      GH_USERNAME: ${{ secrets.BOT_USER }}
      GH_TOKEN: ${{ secrets.BOT_GITHUB_TOKEN }}
