name: Build Node.js Image

on:
  workflow_call:
    secrets:
      BOT_DOCKER_USERNAME:
        required: true
      BOT_DOCKER_TOKEN:
        required: true
      BOT_USER:
        required: true
      BOT_GITHUB_TOKEN:
        required: true

jobs:
  build-node-16-image:
    uses: ./.github/workflows/build-image.yml
    with:
      image_path: containers/node
      image_name: node-pipeline
      image_tag: "16"
      build_args: |
        NODE_VERSION=v16.20.2
        NODE_CHECKSUM=874463523f26ed528634580247f403d200ba17a31adf2de98a7b124c6eb33d87
        NODE_CHECKSUM_ARM=e88d86154d1ce53dc52fd74d79d4bfdf0b05f58c0bb2639adfa36e9378b770c4
    secrets:
      DOCKER_USERNAME: ${{ secrets.BOT_DOCKER_USERNAME }}
      DOCKER_TOKEN: ${{ secrets.BOT_DOCKER_TOKEN }}
      GH_USERNAME: ${{ secrets.BOT_USER }}
      GH_TOKEN: ${{ secrets.BOT_GITHUB_TOKEN }}

  build-node-image:
    uses: ./.github/workflows/build-image.yml
    with:
      image_path: containers/node
      image_name: node-pipeline
      image_tag: "18"
    secrets:
      DOCKER_USERNAME: ${{ secrets.BOT_DOCKER_USERNAME }}
      DOCKER_TOKEN: ${{ secrets.BOT_DOCKER_TOKEN }}
      GH_USERNAME: ${{ secrets.BOT_USER }}
      GH_TOKEN: ${{ secrets.BOT_GITHUB_TOKEN }}

  build-node-20-image:
    uses: ./.github/workflows/build-image.yml
    with:
      image_path: containers/node
      image_name: node-pipeline
      image_tag: "20"
      build_args: |
        NODE_VERSION=v20.7.0
        NODE_CHECKSUM=a4251c24c6bf6d3bdee4521ca294bc0897a6c466137e02caa2521af5d456f55e
        NODE_CHECKSUM_ARM=c97b51decb0f4a3e8e5bd8cbc6ff43ae4782f2b8b6e3c2b513b77b8f97fffcc5
    secrets:
      DOCKER_USERNAME: ${{ secrets.BOT_DOCKER_USERNAME }}
      DOCKER_TOKEN: ${{ secrets.BOT_DOCKER_TOKEN }}
      GH_USERNAME: ${{ secrets.BOT_USER }}
      GH_TOKEN: ${{ secrets.BOT_GITHUB_TOKEN }}
